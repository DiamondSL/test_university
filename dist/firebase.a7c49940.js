var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},t={},a={},n=e.parcelRequire189f;null==n&&((n=function(e){if(e in t)return t[e].exports;if(e in a){var n=a[e];delete a[e];var r={id:e,exports:{}};return t[e]=r,n.call(r.exports,r,r.exports),r.exports}var i=new Error("Cannot find module '"+e+"'");throw i.code="MODULE_NOT_FOUND",i}).register=function(e,t){a[e]=t},e.parcelRequire189f=n);var r=n("hlEGb");const i='<form class="styled-form" id="authorDetails" data-flex-column data-centered-item data-default-gap>\n    <input type="text" name="firstName" required minlength="2" placeholder="author first name" />\n    <input type="text" name="lastName" required minlength="1" placeholder="author last name" />\n    <input type="email" name="authorEmail" required minlength="3" placeholder="author email"/>\n    <input type="submit" hidden id="author-submit" />\n    </form>',o='<form id="upload-file-form" method="post" encType="multipart/form-data"><input type="file" hidden="hidden"/><button type="submit">submit</button></form>',l='<form class="styled-form" id="newsletter-post-form" data-flex-row data-default-gap data-wrap>\n    <input type="text" name="postName" required minlength="2" placeholder="post name" />\n    <input type="text" name="postCategory" required minlength="2" placeholder="post category" />\n    <div data-flex-column data-min-gap data-centered-item id="upload-image-div">\n    <button id="upload-file">upload file</button>\n    <p>or</p>\n    <input type="url" name="imageUrl" required minlength="2" placeholder="visual preview link"/>\n    </div>\n    <input name="postMarkup" placeholder="post markup" />\n    </form>';document.addEventListener("DOMContentLoaded",(e=>{const t=(({classList:e="firebase-form-wrapper",attributes:t=[{name:"data-flex-row",value:""},{name:"data-gap",value:"2"}],appendItems:a=[{position:"afterbegin",element:i},{position:"beforeend",element:l},{position:"afterbegin",element:o}]})=>{const n=document.createElement("div");return Array.isArray(e)?e.forEach((e=>n.classList.add(e?.toString()?.trim()))):e instanceof String?n.classList.add(e?.toString()?.trim()):n.classList.add("firebase-form-wrapper"),Array.isArray(t)&&t.forEach((e=>n.setAttribute(e.name?.trim(),e.value?.trim()))),Array.isArray(a)&&a.forEach((e=>n.insertAdjacentHTML(e.position,e.element))),n})({classList:"firebase-form-wrapper",attributes:[{name:"data-flex-row",value:""},{name:"data-gap",value:"2"}],appendItems:[{position:"afterbegin",element:i},{position:"beforeend",element:l},{position:"beforeend",element:o}]}),a=document.createElement("modal-element");a.insertAdjacentElement("afterbegin",t),a.insertAdjacentHTML("afterbegin","<header data-top-align><h3>Add new newsletter item</h3></header>"),a.insertAdjacentHTML("beforeend",'<div class="submit-container"><button type="submit" disabled id="modal-submit">New newsletter item</button></div>');const n=document.getElementById("add_item"),s=a.querySelector("#upload-file-form"),d=s&&s.children.item(0),m=a.querySelector("#upload-file"),p=a.querySelector("#upload-image-div"),u=a.querySelector("#authorDetails"),c=a.querySelector("#modal-submit"),f=a.querySelector("#newsletter-post-form"),h=document.getElementById("firebase_previews");let g=null,v=null,b=!1,y=!1,w=null;r.getAllPosts.then((e=>e.toJSON())).then((e=>w=Object.entries(e).map((e=>({author:e[0],properties:e[1]}))))).then((e=>{e.map((e=>{const t=e.properties.items&&Object.values(e.properties.items);t&&(({author:e,authorEmail:t,posts:a,container:n})=>{a.forEach((a=>{const r=(({postName:e,authorName:t,postCategory:a,imageUrl:n,postMarkup:r,authorEmail:i})=>`<newsletter-preview data-flex-column data-centered-item style="width: fit-content" author=${t} email=${i}>\n        <h3 slot="header-place-wrapper">${e}</h3>\n        <img slot="preview-image-wrapper" src=${n} alt="visual preview" />\n        <p slot="preview-image-caption">${t?.toString()?.replace("_"," ").trim()} - ${a?.toString()?.replace("_"," ").trim()}</p>\n        <section slot="newsletter-markup">\n            ${r}\n        </section>\n        <button slot="newsletter-preview-actions" class="slotted-button" onclick={console.log(event)}>Open markup</button>\n      </newsletter-preview>`)({postName:a.name,authorName:e,postCategory:a.category,postMarkup:a.markup,imageUrl:a.imagePreview,authorEmail:t});n.insertAdjacentHTML("afterbegin",r)}))})({author:e.author,posts:t,container:h,authorEmail:e.properties.email})})),console.info(h.getElementsByTagName("newsletter-preview"))}));let E={firstName:"",lastName:"",authorEmail:""},L={postName:"",postCategory:"",imageUrl:"",postMarkup:"",authorName:"",authorEmail:""};const N=e=>{e.stopPropagation(),e.stopImmediatePropagation()};return f&&b&&f.addEventListener("submit",(e=>{e.preventDefault(),N(e)})),f.addEventListener("change",(e=>{const{validity:t,value:a,name:n}=e.target;t.valid&&(L[n?.toString()?.trim()]="postMarkup"===n?a?.toString():a?.toString()?.trim()),b&&Object.values(L).every((e=>e.length>2))&&(y=!0,c&&c.removeAttribute("disabled"),c.addEventListener("click",(e=>{(0,r.writePost)(L).then((async e=>{await e}))})))})),u&&u.addEventListener("submit",(e=>{e.preventDefault(),N(e),(0,r.getAuthor)(E.firstName,E.lastName).then((e=>{e.exists()?(b=!0,L.authorName=`${E.firstName}_${E.lastName}`,L.authorEmail=E.authorEmail):(0,r.setAuthor)(E.firstName,E.lastName,E.authorEmail).then((async e=>e)).then((()=>{b=!0})).catch((e=>{console.info(e),b=!1}))})).catch((e=>{console.info(e),b=!1}))})),u&&u.addEventListener("change",(e=>{const{validity:t,value:a,name:n}=e.target;t.valid&&(E[n?.toString()?.trim()]=a?.toString()?.trim()),u.children.length-1===Object.keys(E).length&&u.lastElementChild.click()})),s&&s.addEventListener("click",(e=>N(e))),d&&d.addEventListener("click",(e=>N(e))),m&&m.addEventListener("click",(e=>(e.preventDefault(),e.stopPropagation(),d&&d.click()))),s&&s.addEventListener("submit",(e=>{N(e),e.preventDefault(),g&&g instanceof File&&(0,r.uploadVisualElement)(g).then((e=>{p.style.pointerEvents="none",p.style.opacity=".1",p.lastElementChild.value=e,p.lastElementChild.innerText=e,L.imageUrl=e,v=e}))})),d&&d.addEventListener("change",(()=>{d.files[0]&&(d.files[0].type.includes("image")||d.files[0].type.includes("video"))&&(g=d.files[0],s.children[1].click())})),document.body.insertAdjacentElement("afterbegin",a),n.addEventListener("click",(e=>{e.preventDefault(),a.show()})),{dataBase:r.dataBase,setAuthor:r.setAuthor,writePost:r.writePost}}));
//# sourceMappingURL=firebase.a7c49940.js.map
