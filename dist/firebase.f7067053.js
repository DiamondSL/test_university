var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},t={},a={},n=e.parcelRequire189f;null==n&&((n=function(e){if(e in t)return t[e].exports;if(e in a){var n=a[e];delete a[e];var i={id:e,exports:{}};return t[e]=i,n.call(i.exports,i,i.exports),i.exports}var r=new Error("Cannot find module '"+e+"'");throw r.code="MODULE_NOT_FOUND",r}).register=function(e,t){a[e]=t},e.parcelRequire189f=n);var i=n("hlEGb");document.addEventListener("DOMContentLoaded",(e=>{const t=document.createElement("div");t.classList.add("firebase-form-wrapper"),t.setAttribute("data-flex-row",""),t.setAttribute("data-gap","2"),t.insertAdjacentHTML("afterbegin",'<form class="styled-form" id="authorDetails" data-flex-column data-centered-item data-default-gap>\n    <input type="text" name="firstName" required minlength="2" placeholder="author first name" />\n    <input type="text" name="lastName" required minlength="1" placeholder="author last name" />\n    <input type="email" name="authorEmail" required minlength="3" placeholder="author email"/>\n    <input type="submit" hidden id="author-submit" />\n    </form>'),t.insertAdjacentHTML("beforeend",'<form class="styled-form" id="newsletter-post-form" data-flex-row data-default-gap data-wrap>\n    <input type="text" name="postName" required minlength="2" placeholder="post name" />\n    <input type="text" name="postCategory" required minlength="2" placeholder="post category" />\n    <div data-flex-column data-min-gap data-centered-item id="upload-image-div">\n    <button id="upload-file">upload file</button>\n    <p>or</p>\n    <input type="url" name="imageUrl" required minlength="2" placeholder="visual preview link"/>\n    </div>\n    <input name="postMarkup" placeholder="post markup" />\n    </form>'),t.insertAdjacentHTML("afterbegin",'<form id="upload-file-form" method="post" encType="multipart/form-data"><input type="file" hidden="hidden"/><button type="submit">submit</button></form>');const a=document.createElement("modal-element");a.insertAdjacentElement("afterbegin",t),a.insertAdjacentHTML("afterbegin","<header data-top-align><h3>Add new newsletter item</h3></header>"),a.insertAdjacentHTML("beforeend",'<div class="submit-container"><button type="submit" disabled id="modal-submit">New newsletter item</button></div>');const n=document.getElementById("add_item"),r=a.querySelector("#upload-file-form"),l=r&&r.children.item(0),o=a.querySelector("#upload-file"),d=a.querySelector("#upload-image-div"),s=a.querySelector("#authorDetails"),u=a.querySelector("#modal-submit"),m=a.querySelector("#newsletter-post-form");let p=null,c=null,f=!1,h=!1,g={firstName:"",lastName:"",authorEmail:""},v={postName:"",postCategory:"",imageUrl:"",postMarkup:"",authorName:"",authorEmail:""};const y=e=>{e.stopPropagation(),e.stopImmediatePropagation()};return m&&f&&m.addEventListener("submit",(e=>{e.preventDefault(),y(e),console.info(f,v)})),m.addEventListener("change",(e=>{const{validity:t,value:a,name:n}=e.target;t.valid&&(v[n?.toString()?.trim()]="postMarkup"===n?a?.toString():a?.toString()?.trim()),f&&Object.values(v).every((e=>e.length>2))&&(h=!0,u&&u.removeAttribute("disabled"),u.addEventListener("click",(e=>{(0,i.writePost)(v).then((async e=>{await e}))})))})),s&&s.addEventListener("submit",(e=>{e.preventDefault(),y(e),(0,i.getAuthor)(g.firstName,g.lastName).then((e=>{e.exists()?(f=!0,v.authorName=`${g.firstName}_${g.lastName}`,v.authorEmail=g.authorEmail):(0,i.setAuthor)(g.firstName,g.lastName,g.authorEmail).then((async e=>e)).then((()=>{f=!0})).catch((e=>{console.info(e),f=!1}))})).catch((e=>{console.info(e),f=!1}))})),s&&s.addEventListener("change",(e=>{const{validity:t,value:a,name:n}=e.target;t.valid&&(g[n?.toString()?.trim()]=a?.toString()?.trim()),s.children.length-1===Object.keys(g).length&&s.lastElementChild.click()})),r&&r.addEventListener("click",(e=>y(e))),l&&l.addEventListener("click",(e=>y(e))),o&&o.addEventListener("click",(e=>(e.preventDefault(),e.stopPropagation(),l&&l.click()))),r&&r.addEventListener("submit",(e=>{y(e),e.preventDefault(),p&&p instanceof File&&(0,i.uploadVisualElement)(p).then((e=>{d.style.pointerEvents="none",d.style.opacity=".1",d.lastElementChild.value=e,d.lastElementChild.innerText=e,v.imageUrl=e,c=e}))})),l&&l.addEventListener("change",(()=>{l.files[0]&&(l.files[0].type.includes("image")||l.files[0].type.includes("video"))&&(p=l.files[0],r.children[1].click())})),document.body.insertAdjacentElement("afterbegin",a),n.addEventListener("click",(e=>{e.preventDefault(),a.show()})),{dataBase:i.dataBase,setAuthor:i.setAuthor,writePost:i.writePost}}));
//# sourceMappingURL=firebase.f7067053.js.map
